import { PrismaClient } from '@prisma/client';
import { THREAT_STATUS } from '../../src/constants/threats.constants';
import { convertISO8601noTZtoDateObj } from '../../src/services/helpers/shared.helpers.service';
import { DUMMY_DASHBOARD_APP } from '../../src/constants/common.constants';

const prisma = new PrismaClient();

export const upsert3QuarantinedThreatSeeds = async () => {
  await prisma.threat.upsert({
    where: {
      id: '9be58d1b-e6ed-4269-b049-af87fdfc5c90',
      sha256: '2F9C81C603D18CE44BFBDD786F4842DB5C12AEB71A1EA235315619C48C821E7F',
      filePath: 'C:\\TEMP\\QakBot.exe'
    },
    update: {
      dashboardTenantId: '1a332818-654b-4388-9448-b4bdfc6d69cb',
      tenantName: 'Bob',
      downloadPath: 'PLACE_HOLDER_URL',
      status: THREAT_STATUS.QUARANTINED,
      appliedTo: '["9be58d1b-e6ed-4269-b049-af87fdfc5c90"]',
      reason: 'N.A.',
      addedBy: DUMMY_DASHBOARD_APP,
      addedOn: new Date('2024-03-06T00:21:00.000Z'),
      agentVersion: '3.1.1005',
      autoRun: false,
      avIndustry: null,
      certIssuer: '',
      certPublisher: '',
      certTimestamp: convertISO8601noTZtoDateObj('0001-01-01T00:00:02'),
      classification: 'Malware',
      cylanceDeviceId: 'c89c264d-b1e6-4a28-8c40-0368cf994d07',
      cylanceScore: -701.022,
      detectedBy: 'Background Threat Detection-2',
      deviceName: 'QDUMMYMCBT1',
      deviceState: 'online',
      fileName: 'Qakbot.exe',
      filePath: 'C:\\TEMP\\QakBot.exe',
      fileSize: 33176,
      fileStatus: 'SafeListed',
      globalQuarantined: true,
      safelisted: false,
      ipAddresses: '["165.244.95.219"]',
      lastFound: convertISO8601noTZtoDateObj('2023-10-05T08:55:23'),
      macAddresses: '["00-50-56-B1-88-7H"]',
      md5: 'a997ffc1eef4644d4b863365ed018503',
      running: false,
      sha256: '2F9C81C603D18CE44BFBDD786F4842DB5C12AEB71A1EA235315619C48C821E7F',
      signed: false,
      subClassification: '',
      uniqueToCylance: false,
      zones: ['Safe-1']
    },
    create: {
      dashboardTenantId: '1a332818-654b-4388-9448-b4bdfc6d69cb',
      tenantName: 'Bob',
      downloadPath: 'PLACE_HOLDER_URL',
      status: THREAT_STATUS.QUARANTINED,
      appliedTo: '["9be58d1b-e6ed-4269-b049-af87fdfc5c90"]',
      reason: 'N.A.',
      addedBy: DUMMY_DASHBOARD_APP,
      addedOn: new Date('2024-03-06T00:21:00.000Z'),
      agentVersion: '3.1.1005',
      autoRun: false,
      avIndustry: null,
      certIssuer: '',
      certPublisher: '',
      certTimestamp: convertISO8601noTZtoDateObj('0001-01-01T00:00:02'),
      classification: 'Malware',
      cylanceDeviceId: 'c89c264d-b1e6-4a28-8c40-0368cf994d07',
      cylanceScore: -701.022,
      detectedBy: 'Background Threat Detection-2',
      deviceName: 'QDUMMYMCBT1',
      deviceState: 'online',
      fileName: 'Qakbot.exe',
      filePath: 'C:\\TEMP\\QakBot.exe',
      fileSize: 33176,
      fileStatus: 'Safelisted',
      globalQuarantined: true,
      safelisted: false,
      ipAddresses: '["165.244.95.219"]',
      lastFound: convertISO8601noTZtoDateObj('2023-10-05T08:55:23'),
      macAddresses: '["00-50-56-B1-88-7H"]',
      md5: 'a997ffc1eef4644d4b863365ed018503',
      running: false,
      sha256: '2F9C81C603D18CE44BFBDD786F4842DB5C12AEB71A1EA235315619C48C821E7F',
      signed: false,
      subClassification: '',
      uniqueToCylance: false,
      zones: ['Safe-1']
    }
  });
  await prisma.threat.upsert({
    where: {
      id: 'b85b95d0-113a-4240-af95-b8e17f956cfe',
      sha256: '1C31300178EDDB21416CE38FBB8488235293C3A207D591A4502899DE50168FB3',
      filePath: 'C:\\TEMP\\TrickBot.exe'
    },
    update: {
      dashboardTenantId: '09cee12b-6fa8-45bd-8769-657e8ca5a476',
      tenantName: 'Krueger',
      downloadPath: 'PLACE_HOLDER_URL',
      status: THREAT_STATUS.QUARANTINED,
      appliedTo: '["b85b95d0-113a-4240-af95-b8e17f956cfe"]',
      reason: 'N.A.',
      addedBy: DUMMY_DASHBOARD_APP,
      addedOn: new Date('2024-03-06T00:22:00.000Z'),
      agentVersion: '3.1.1001',
      autoRun: false,
      avIndustry: 1,
      certIssuer: null,
      certPublisher: null,
      certTimestamp: convertISO8601noTZtoDateObj('0001-01-01T00:00:03'),
      classification: 'Malware',
      cylanceDeviceId: '1d2f7cfa-b2e8-41ac-ab14-f42da4fd27bb',
      cylanceScore: -910.133,
      detectedBy: 'Background Threat Detection',
      deviceName: 'DMMY2QTHE',
      deviceState: 'online',
      fileName: 'TrickBot.exe',
      filePath: 'C:\\TEMP\\TrickBot.exe',
      fileSize: 11575,
      fileStatus: 'Quarantined',
      globalQuarantined: true,
      safelisted: false,
      ipAddresses: '["165.244.95.366"]',
      lastFound: convertISO8601noTZtoDateObj('2023-10-05T09:30:00'),
      macAddresses: '["98-32-3T-B1-85-7D"]',
      md5: 'b9a29c775d504a210ded6f1a09702d67',
      running: false,
      sha256: '1C31300178EDDB21416CE38FBB8488235293C3A207D591A4502899DE50168FB3',
      signed: false,
      subClassification: 'Adware2',
      uniqueToCylance: true,
      zones: ['Safe-1']
    },
    create: {
      dashboardTenantId: '09cee12b-6fa8-45bd-8769-657e8ca5a476',
      tenantName: 'Krueger',
      downloadPath: 'PLACE_HOLDER_URL',
      status: THREAT_STATUS.QUARANTINED,
      appliedTo: '["b85b95d0-113a-4240-af95-b8e17f956cfe"]',
      reason: 'N.A.',
      addedBy: DUMMY_DASHBOARD_APP,
      addedOn: new Date('2024-03-06T00:22:00.000Z'),
      agentVersion: '3.1.1001',
      autoRun: false,
      avIndustry: 1,
      certIssuer: null,
      certPublisher: null,
      certTimestamp: convertISO8601noTZtoDateObj('0001-01-01T00:00:03'),
      classification: 'Malware',
      cylanceDeviceId: '1d2f7cfa-b2e8-41ac-ab14-f42da4fd27bb',
      cylanceScore: -910.133,
      detectedBy: 'Background Threat Detection',
      deviceName: 'DMMY2QTHE',
      deviceState: 'online',
      fileName: 'TrickBot.exe',
      filePath: 'C:\\TEMP\\TrickBot.exe',
      fileSize: 11575,
      fileStatus: 'Quarantined',
      globalQuarantined: true,
      safelisted: false,
      ipAddresses: '["165.244.95.366"]',
      lastFound: convertISO8601noTZtoDateObj('2023-10-05T09:30:00'),
      macAddresses: '["98-32-3T-B1-85-7D"]',
      md5: 'b9a29c775d504a210ded6f1a09702d67',
      running: false,
      sha256: '1C31300178EDDB21416CE38FBB8488235293C3A207D591A4502899DE50168FB3',
      signed: false,
      subClassification: 'Adware2',
      uniqueToCylance: true,
      zones: ['Safe-1']
    }
  });

  await prisma.threat.upsert({
    where: {
      id: 'ccf909ca-b55c-49ff-a3ec-2f8031fe950e',
      sha256: '1C31300178EDDB21416CE38FBB8488235293C3A207D591A4502899DE50168FB3',
      filePath: 'C:\\Users\\TrickBot.exe'
    },
    update: {
      dashboardTenantId: '09cee12b-6fa8-45bd-8769-657e8ca5a476',
      tenantName: 'Krueger',
      downloadPath: 'PLACE_HOLDER_URL',
      status: THREAT_STATUS.QUARANTINED,
      appliedTo: '["ccf909ca-b55c-49ff-a3ec-2f8031fe950e"]',
      reason: 'N.A.',
      addedBy: DUMMY_DASHBOARD_APP,
      addedOn: new Date('2024-03-06T00:23:00.000Z'),
      agentVersion: '3.1.1001',
      autoRun: false,
      avIndustry: 1,
      certIssuer: null,
      certPublisher: null,
      certTimestamp: convertISO8601noTZtoDateObj('0001-01-01T00:00:02'),
      classification: 'Malware',
      cylanceDeviceId: '1d2f7cfa-b2e8-41ac-ab14-f42da4fd27bb',
      cylanceScore: -910.133,
      detectedBy: 'Background Threat Detection',
      deviceName: 'DMMY2QTHE',
      deviceState: 'online',
      fileName: 'TrickBot2.exe',
      filePath: 'C:\\Users\\TrickBot2.exe',
      fileSize: 11575,
      fileStatus: 'Quarantined',
      globalQuarantined: true,
      safelisted: false,
      ipAddresses: '["165.244.95.366"]',
      lastFound: convertISO8601noTZtoDateObj('2023-10-05T09:25:00'),
      macAddresses: '["98-32-3T-B1-85-7D"]',
      md5: 'b9a29c775d504a210ded6f1a09702d67',
      running: false,
      sha256: '1C31300178EDDB21416CE38FBB8488235293C3A207D591A4502899DE50168FB3',
      signed: false,
      subClassification: 'Adware2',
      uniqueToCylance: true,
      zones: ['Safe-1']
    },
    create: {
      dashboardTenantId: '09cee12b-6fa8-45bd-8769-657e8ca5a476',
      tenantName: 'Krueger',
      downloadPath: 'PLACE_HOLDER_URL',
      status: THREAT_STATUS.QUARANTINED,
      appliedTo: '["ccf909ca-b55c-49ff-a3ec-2f8031fe950e"]',
      reason: 'N.A.',
      addedBy: DUMMY_DASHBOARD_APP,
      addedOn: new Date('2024-03-06T00:23:00.000Z'),
      agentVersion: '3.1.1001',
      autoRun: false,
      avIndustry: 1,
      certIssuer: null,
      certPublisher: null,
      certTimestamp: convertISO8601noTZtoDateObj('0001-01-01T00:00:02'),
      classification: 'Malware',
      cylanceDeviceId: '1d2f7cfa-b2e8-41ac-ab14-f42da4fd27bb',
      cylanceScore: -910.133,
      detectedBy: 'Background Threat Detection',
      deviceName: 'DMMY2QTHE',
      deviceState: 'online',
      fileName: 'TrickBot2.exe',
      filePath: 'C:\\TEMP\\TrickBot2.exe',
      fileSize: 11575,
      fileStatus: 'Quarantined',
      globalQuarantined: true,
      safelisted: false,
      ipAddresses: '["165.244.95.366"]',
      lastFound: convertISO8601noTZtoDateObj('2023-10-05T09:25:00'),
      macAddresses: '["98-32-3T-B1-85-7D"]',
      md5: 'b9a29c775d504a210ded6f1a09702d67',
      running: false,
      sha256: '1C31300178EDDB21416CE38FBB8488235293C3A207D591A4502899DE50168FB3',
      signed: false,
      subClassification: 'Adware2',
      uniqueToCylance: true,
      zones: ['Safe-1']
    }
  });
};
