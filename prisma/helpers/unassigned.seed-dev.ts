import { PrismaClient } from '@prisma/client';
import { THREAT_STATUS } from '../../src/constants/threats.constants';
import { convertISO8601noTZtoDateObj } from '../../src/services/helpers/shared.helpers.service';
// import { DUMMY_DASHBOARD_APP } from '../../src/constants/common.constants';

const prisma = new PrismaClient();

export const upsert2UnassignedThreatSeeds = async () => {
  await prisma.threat.upsert({
    where: {
      id: '54c0da29-0a15-47a3-9cc8-3ff07bbdc694',
      sha256: '88D8537772A70F5D473975FF151A16FCF18AB25C72FB57310E9A7DAB82904C14',
      filePath: 'C:\\tmp\\ISM_DBMS_Oracle_Win_2.0.4.8\\ism_ora.exe'
    },
    update: {
      dashboardTenantId: '96d17043-c023-413e-9c82-c85957cd668e',
      tenantName: 'Eagle Corporation',
      downloadPath: 'PLACE_HOLDER_URL',
      status: THREAT_STATUS.UNASSIGNED,
      appliedTo: JSON.stringify([]),
      reason: 'N.A.',
      addedBy: '',
      addedOn: new Date('2024-05-06T00:00:00.000Z'),
      agentVersion: '3.1.1001',
      autoRun: false,
      avIndustry: null,
      certIssuer: '',
      certPublisher: '',
      certTimestamp: convertISO8601noTZtoDateObj('0001-01-01T00:00:00'),
      classification: '',
      cylanceDeviceId: '03c40f35-bbab-4a57-93c9-32f2f476d4a4',
      cylanceScore: -0.036,
      detectedBy: 'Background Threat Detection',
      deviceName: 'LCHDPLMPOB1',
      deviceState: 'online',
      fileName: 'ism_ora.exe',
      filePath: 'C:\\tmp\\ISM_DBMS_Oracle_Win_2.0.4.8\\ism_ora.exe',
      fileSize: 442368,
      fileStatus: 'Quarantined',
      globalQuarantined: false,
      safelisted: false,
      ipAddresses: '["165.244.95.207"]',
      lastFound: convertISO8601noTZtoDateObj('2023-10-05T05:50:17'),
      macAddresses: '["00-50-56-B1-79-3D"]',
      md5: '984F6F98C08864859E5772BE6945EE44',
      running: false,
      sha256: '88D8537772A70F5D473975FF151A16FCF18AB25C72FB57310E9A7DAB82904C14',
      signed: false,
      subClassification: '',
      uniqueToCylance: false,
      zones: ['Green']
    },
    create: {
      dashboardTenantId: '96d17043-c023-413e-9c82-c85957cd668e',
      tenantName: 'Eagle Corporation',
      downloadPath: 'PLACE_HOLDER_URL',
      status: THREAT_STATUS.UNASSIGNED,
      appliedTo: JSON.stringify([]),
      reason: 'N.A.',
      addedBy: '',
      addedOn: new Date('2024-05-06T00:00:00.000Z'),
      agentVersion: '3.1.1001',
      autoRun: false,
      avIndustry: null,
      certIssuer: '',
      certPublisher: '',
      certTimestamp: convertISO8601noTZtoDateObj('0001-01-01T00:00:00'),
      classification: '',
      cylanceDeviceId: '03c40f35-bbab-4a57-93c9-32f2f476d4a4',
      cylanceScore: -0.036,
      detectedBy: 'Background Threat Detection',
      deviceName: 'LCHDPLMPOB1',
      deviceState: 'online',
      fileName: 'ism_ora.exe',
      filePath: 'C:\\tmp\\ISM_DBMS_Oracle_Win_2.0.4.8\\ism_ora.exe',
      fileSize: 442368,
      fileStatus: 'Quarantined',
      globalQuarantined: false,
      safelisted: false,
      ipAddresses: '["165.244.95.207"]',
      lastFound: convertISO8601noTZtoDateObj('2023-10-05T05:50:17'),
      macAddresses: '["00-50-56-B1-79-3D"]',
      md5: '984F6F98C08864859E5772BE6945EE44',
      running: false,
      sha256: '88D8537772A70F5D473975FF151A16FCF18AB25C72FB57310E9A7DAB82904C14',
      signed: false,
      subClassification: '',
      uniqueToCylance: false,
      zones: ['Green']
    }
  });

  await prisma.threat.upsert({
    where: {
      id: '83824905-0724-4b11-b56e-1646c33e9464',
      sha256: '273448A390BAF55994600CB76230E6C266CE06A85B6593C8B42AC78F84558F5F',
      filePath: 'C:\\TEMP\\RmAgent4_roll.exe'
    },
    update: {
      dashboardTenantId: '96d17043-c023-413e-9c82-c85957cd668e',
      tenantName: 'Eagle Corporation',
      downloadPath: 'PLACE_HOLDER_URL',
      status: THREAT_STATUS.UNASSIGNED,
      appliedTo: JSON.stringify([]),
      reason: 'N.A.',
      addedBy: '',
      addedOn: new Date('2024-05-06T00:10:00.000Z'),
      agentVersion: '3.1.1001',
      autoRun: false,
      avIndustry: 1,
      certIssuer: null,
      certPublisher: null,
      certTimestamp: convertISO8601noTZtoDateObj('0001-01-01T00:00:00'),
      classification: 'PUP',
      cylanceDeviceId: '03c40f35-bbab-4a57-93c9-32f2f476d4a4',
      cylanceScore: -0.999,
      detectedBy: 'Background Threat Detection',
      deviceName: 'LCHDPLMPOB1',
      deviceState: 'online',
      fileName: 'RmAgent4_roll.exe',
      filePath: 'C:\\TEMP\\RmAgent4_roll.exe',
      fileSize: 90975,
      fileStatus: 'Quarantined',
      globalQuarantined: false,
      safelisted: false,
      ipAddresses: '["165.244.95.207"]',
      lastFound: convertISO8601noTZtoDateObj('2023-10-05T05:50:15'),
      macAddresses: '["00-50-56-B1-79-3D"]',
      md5: '080A0D01363500410000000000000000',
      running: false,
      sha256: '273448A390BAF55994600CB76230E6C266CE06A85B6593C8B42AC78F84558F5F',
      signed: false,
      subClassification: 'Adware',
      uniqueToCylance: true,
      zones: ['Green']
    },
    create: {
      dashboardTenantId: '96d17043-c023-413e-9c82-c85957cd668e',
      tenantName: 'Eagle Corporation',
      downloadPath: 'PLACE_HOLDER_URL',
      status: THREAT_STATUS.UNASSIGNED,
      appliedTo: JSON.stringify([]),
      reason: 'N.A.',
      addedBy: '',
      addedOn: new Date('2024-05-06T00:10:00.000Z'),
      agentVersion: '3.1.1001',
      autoRun: false,
      avIndustry: 1,
      certIssuer: null,
      certPublisher: null,
      certTimestamp: convertISO8601noTZtoDateObj('0001-01-01T00:00:00'),
      classification: 'PUP',
      cylanceDeviceId: '03c40f35-bbab-4a57-93c9-32f2f476d4a4',
      cylanceScore: -0.999,
      detectedBy: 'Background Threat Detection',
      deviceName: 'LCHDPLMPOB1',
      deviceState: 'online',
      fileName: 'RmAgent4_roll.exe',
      filePath: 'C:\\TEMP\\RmAgent4_roll.exe',
      fileSize: 90975,
      fileStatus: 'Quarantined',
      globalQuarantined: false,
      safelisted: false,
      ipAddresses: '["165.244.95.207"]',
      lastFound: convertISO8601noTZtoDateObj('2023-10-05T05:50:15'),
      macAddresses: '["00-50-56-B1-79-3D"]',
      md5: '080A0D01363500410000000000000000',
      running: false,
      sha256: '273448A390BAF55994600CB76230E6C266CE06A85B6593C8B42AC78F84558F5F',
      signed: false,
      subClassification: 'Adware',
      uniqueToCylance: true,
      zones: ['Green']
    }
  });
};
